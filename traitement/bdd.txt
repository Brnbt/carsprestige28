CREATE DATABASE IF NOT EXISTS cars_prestige_28;
USE cars_prestige_28;

CREATE TABLE chauffeur (
    id_chauffeur INT PRIMARY KEY AUTO_INCREMENT,
    nom VARCHAR(50),
    prenom VARCHAR(50),
    telephone VARCHAR(20),
    email VARCHAR(100),
    numero_permis VARCHAR(30),
    date_validite_permis DATE,
    vehicule_id INT
);

CREATE TABLE vehicule (
    id_vehicule INT PRIMARY KEY AUTO_INCREMENT,
    marque VARCHAR(50),
    modele VARCHAR(50),
    immatriculation VARCHAR(20),
    couleur VARCHAR(20),
    date_mise_en_service DATE
);

CREATE TABLE client (
    id_client INT PRIMARY KEY AUTO_INCREMENT,
    nom VARCHAR(50),
    prenom VARCHAR(50),
    telephone VARCHAR(20),
    email VARCHAR(100)
);

CREATE TABLE course (
    id_course INT PRIMARY KEY AUTO_INCREMENT,
    id_client INT,
    id_chauffeur INT,
    date_course DATETIME,
    point_depart VARCHAR(255),
    point_arrivee VARCHAR(255),
    distance_km DECIMAL(5,2),
    prix DECIMAL(10,2),
    statut ENUM('en attente', 'en cours', 'terminée', 'annulée'),
    FOREIGN KEY (id_client) REFERENCES client(id_client),
    FOREIGN KEY (id_chauffeur) REFERENCES chauffeur(id_chauffeur)
);

CREATE TABLE facture (
    id_facture INT PRIMARY KEY AUTO_INCREMENT,
    id_course INT,
    date_facture DATE,
    montant DECIMAL(10,2),
    mode_paiement ENUM('carte', 'espèces', 'virement'),
    statut ENUM('payée', 'impayée'),
    FOREIGN KEY (id_course) REFERENCES course(id_course)
);

ALTER TABLE chauffeur
ADD FOREIGN KEY (vehicule_id) REFERENCES vehicule(id_vehicule);
